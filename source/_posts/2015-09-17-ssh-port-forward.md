---
author: ety001
title: ssh端口转发
layout: post
tags:
- Server&OS
---
使用ssh进行端口转发分为两种，本地转发和远程转发。

##基本参数：

* -C 压缩
* -g global forward 全局转发，否则只能绑定到127.0.0.1
* -R 远程转发
* -L 本地转发
* -f 后台认证用户/密码，通常和-N连用，不用登录到远程主机
* -N 不执行脚本或命令，通常与-f连用。

##本地转发：

![local_forward](/assets/upload/20150917/091701.jpg)

```
ssh -C -f -N -g -R 6300:192.168.1.1:80 10.10.10.10
```

意思可以这么理解：

```
ssh连接到10.10.10.10上，告诉10.10.10.10，现在所有访问192.168.1.1上的80的数据
都会转发到你的6300上。

6300:192.168.1.1:80 这一串，可以理解为访问流是从右往左的。
```

##远程转发：

![local_forward](/assets/upload/20150917/091702.jpg)

```
ssh -C -f -N -g -R 6300:192.168.1.1:8080 10.10.10.10
```

意思可以这么理解：

```
ssh连接到10.10.10.10上，告诉10.10.10.10，现在所有访问你的6300的数据都转发到192.168.1.1的8080端口上。

6300:192.168.1.1:8080 这一串，可以理解为访问流是从左往右的。
```

##附：

把本地的80端口映射到远程公网服务器(x.x.x.x)的8080端口上：

```
ssh -C -f -N -g -R 8080:localhost:80 x.x.x.x
```

参考：<http://blog.csdn.net/a351945755/article/details/21785647>，图片使用了该文的图片。

PS: 如果用的是openssh，先设置`GatewayPorts`为`yes`
